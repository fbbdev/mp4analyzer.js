<!DOCTYPE html>
<html>
  <head>
    <title>mp4analyzer.js</title>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,width=device-width,user-scalable=no">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="/js/subdomain.js"></script>
    <script src="js/mp4analyzer.opt.js"></script>
    <script>
      function handleFile(files) {
        if (!MP4.supported || !files || !files.length) return;

        var file = files[0];
        if (file.rewind) file.rewind();
        else if (file.g) file.g = 0;
        $('#info span').text('');
        $('#error').text('No error');
        if (!file) return;
        $('#name').text(file.name);
        $('#type').text(file.type);
        $('#size').text(file.size);

        MP4.analyze(file, function(info) {
          if (info.video) $('#vcodec').text(info.video.codec);
          if (info.audio) $('#acodec').text(info.audio.codec);
          if (info.error) $('#error').text(info.error.message);
        });
      }

      $(document).ready(function() {
        getCookieConsent($('.cookie-banner')[0], '.fbbdev.it');

        if (!MP4.supported) {
          $('#demo section .error').text('Your browser does not support mp4analyzer.js');
        } else {
          $('#demo section').append($('script#demo-html').remove().html()).children('.error').remove();

          $('#demo #btn-movie-selector').click(function(ev) {
            ev.preventDefault();
            $('#movie-selector').click();
          });

          $('#demo #movie-selector').change(function() {
            handleFile(this.files);
          });

          $('#demo #movie-dropper').on('drop', function(ev) {
            handleFile(ev.originalEvent.dataTransfer.files);
          });
        }

        $(document).on('dragover', '.dropslot', function(ev) {
            ev.preventDefault();
        }).on('dragenter dragleave', '.dropslot', function(ev) {
            $(ev.target).toggleClass('active');
        }).on('drop', '.dropslot', function(ev) {
            ev.preventDefault();
            $(ev.target).removeClass('active');
        });
      });
    </script>

    <link rel="stylesheet" href="/css/subdomain.css">
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/screen.css">
    <link rel="stylesheet" href="css/index.css">
  </head>
  <body>
    <div class="cookie-banner">
      This website is using cookies.
      By staying on our website you agree to our use of cookies.
      <a href="/cookies">Learn more</a>
      <a class="confirm" href="#" style="margin-left: 10px;">Got it</a>
    </div>
    <a class="logo light" href="/">
      fbbdev.it
    </a>
    <header class="fullscreen" id="title">
      <div class="scrolldown"><i class="fa fa-angle-down"></i></div>
      <div class="vcenter">
        <h1>mp4analyzer.js</h1>
        <h2>JavaScript MP4/M4A/MOV file parser</h2>
        <nav>
          <a class="btn" href="#demo"><i class="fa fa-puzzle-piece"></i>&nbsp;&nbsp;Demo</a>
          <a class="btn" href="#docs"><i class="fa fa-file-o"></i>&nbsp;&nbsp;Docs</a>
          <a class="btn" href="#download"><i class="fa fa-download"></i>&nbsp;&nbsp;Download</a>
        </nav>
      </div>
    </header>

    <article class="fullscreen" id="demo">
      <section class="vcenter">
        <h1>Demo</h1>
        <div class="error">Sorry, you need JavaScript to view the demo</div>
        <script type="text/html" id="demo-html">
          <div class="demo-content">
            <div class="demo-block box code" id="demo-code"><span style="color: #ddd; font-style: italic;">&lt;!DOCTYPE html&gt;</span>
&lt;html&gt;
  &lt;head&gt;
    &lt;script src=<span style="color: #cc8;">&quot;url/to/mp4analyzer.opt.js&quot;</span>&gt;&lt;/script&gt;
    &lt;script&gt;
      <span style="color: #f84; font-weight: bold;">if</span> (<span style="font-weight: bold;">!</span>MP4.supported) {
        <span style="color: #ddd; font-style: italic;">// mp4analyzer is not supported by this browser</span>
        <span style="color: #ddd; font-style: italic;">// (FileReader or DataView API not supported)</span>
      }

      <span style="color: #f84; font-weight: bold;">function</span> handleFile(files) {
        <span style="color: #f84; font-weight: bold;">if</span> (files && files.<span style="color: #f84;">length</span>)
          MP4.analyze(files[<span style="color: #cc8;">0</span>], <span style="color: #f84; font-weight: bold;">function</span>(result) {
            <span style="color: #ddd; font-style: italic;">// do something</span>
          });
      }
    &lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;input type=<span style="color: #cc8;">&quot;file&quot;</span> onchange=<span style="color: #cc8;">&quot;handleFile(this.files)&quot;</span>&gt;
  &lt;/body&gt;
&lt;/html&gt;</div>
            <div class="demo-block" id="demo-widget">
              <a class="btn" href="#" id="btn-movie-selector"><i class="fa fa-folder"></i>&nbsp;&nbsp;Choose movie</a><br>
              or
              <div class="dropslot" id="movie-dropper"></div>
              <input type="file" id="movie-selector">
              <div class="box" id="info">
                <b>Name:</b><br>
                <span id="name"></span><br>
                <b>Type:</b><br>
                <span id="type"></span><br>
                <b>Size:</b><br>
                <span id="size"></span><br>
                <b>Video codec:</b><br>
                <span id="vcodec"></span><br>
                <b>Audio codec:</b><br>
                <span id="acodec"></span><br>
                <b>Error:</b><br>
                <span id="error">No error</span><br>
              </div>
            </div>
          </div>
        </script>
      </section>
    </article>

    <article class="fullscreen" id="docs">
      <section class="vcenter">
        <h1>Documentation</h1>
        <h2>Coming soon...</h2>
        <a class="btn" href="https://github.com/fbbdev/mp4analyzer.js/blob/master/README.md">View README</a>
      </section>
    </article>

    <article class="fullscreen" id="download">
      <section class="vcenter">
        <h1>Download</h1>
        <div>
          <a class="btn" href="https://github.com/fbbdev/mp4analyzer.js/releases/download/v0.3/mp4analyzer.min.js">
            mp4analyzer.min.js<br>
            <span>(minified, 7.9 KB)</span>
          </a>
          <a class="btn" href="https://github.com/fbbdev/mp4analyzer.js/releases/download/v0.3/mp4analyzer.opt.js">
            mp4analyzer.opt.js<br>
            <span>(minified and optimized, 4.9 KB)</span>
          </a><br>
          <a class="btn" href="https://github.com/fbbdev/mp4analyzer.js/releases/download/v0.3/mp4analyzer.js">
            mp4analyzer.js<br>
            <span>(plain javascript, 17.7 KB)</span>
          </a>
          <a class="btn" href="https://github.com/fbbdev/mp4analyzer.js/archive/v0.3.zip">
            mp4analyzer.js-0.3.zip<br>
            <span>(source code package, 11.2 KB)</span>
          </a>
        </div><br>
        <a class="btn" href="https://github.com/fbbdev/mp4analyzer.js"><i class="fa fa-github"></i>&nbsp;&nbsp;GitHub repository</a>
      </section>
    </article>
  </body>
</html>
